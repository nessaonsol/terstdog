<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BonkCom</title>
    <link rel="icon" type="image/x-icon" href="bonkcom.jpg">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f9fafb;
            color: #111827;
        }

        .container {
            max-width: 80rem;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Header Styles */
        header {
            background-color: white;
            border-bottom: 1px solid #e5e7eb;
            position: sticky;
            top: 0;
            z-index: 40;
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 4rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.3s;
            cursor: pointer;
            border: none;
            background: none;
        }

        .logo-button:hover {
            background-color: #f9fafb;
        }

        .logo-icon {
            width: 2rem;
            height: 2rem;
            background-color: #f97316;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: bold;
        }

        .logo-subtitle {
            font-size: 0.875rem;
            color: #6b7280;
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
            font-size: 0.875rem;
        }

        .btn-primary {
            background-color: #f97316;
            color: white;
        }

        .btn-primary:hover {
            background-color: #ea580c;
        }

        .btn-secondary {
            border: 1px solid #d1d5db;
            background-color: white;
            color: #374151;
        }

        .btn-secondary:hover {
            background-color: #f9fafb;
        }

        .btn-wallet-connected {
            background-color: #d1fae5;
            color: #047857;
        }

        .btn-wallet-connected:hover {
            background-color: #a7f3d0;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            margin-bottom: 3rem;
            padding-top: 2rem;
        }

        .hero h1 {
            font-size: 2.25rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.25rem;
            color: #4b5563;
            margin-bottom: 2rem;
            max-width: 48rem;
            margin-left: auto;
            margin-right: auto;
        }

        /* Search Bar */
        .search-container {
            max-width: 42rem;
            margin: 0 auto 2rem;
            position: relative;
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 3rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 1rem;
            outline: none;
        }

        .search-input:focus {
            border-color: #f97316;
            box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.1);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            max-width: 56rem;
            margin: 0 auto 3rem;
        }

        .stat-card {
            background-color: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            border: 1px solid #e5e7eb;
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: #4b5563;
            font-size: 0.875rem;
        }

        /* Community Cards */
        .communities-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .community-card {
            background-color: white;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            padding: 1.5rem;
            transition: all 0.3s;
            cursor: pointer;
            opacity: 0;
            transform: translateY(30px);
        }

        .community-card.animate {
            animation: fadeInUp 0.6s ease-out forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .community-card:hover {
            border-color: #fbbf24;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .community-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }

        .community-info {
            display: flex;
            gap: 1rem;
            flex: 1;
        }

        .community-avatar {
            width: 4rem;
            height: 4rem;
            background-color: #e5e7eb;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .community-details {
            flex: 1;
        }

        .community-name {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .verified-icon {
            color: #f97316;
        }

        .community-address {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }

        .community-description {
            color: #4b5563;
            margin-bottom: 0.75rem;
            line-height: 1.5;
        }

        .community-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .tag {
            padding: 0.25rem 0.5rem;
            background-color: #f3f4f6;
            color: #4b5563;
            font-size: 0.75rem;
            border-radius: 9999px;
        }

        .community-stats {
            display: flex;
            gap: 1.5rem;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .online-dot {
            width: 0.5rem;
            height: 0.5rem;
            background-color: #10b981;
            border-radius: 50%;
        }

        /* Chat View */
        .chat-container {
            display: flex;
            flex-direction: column;
            height: calc(100vh - 200px);
        }

        .chat-header {
            background-color: white;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .chat-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .chat-messages {
            flex: 1;
            background-color: white;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            padding: 1rem;
            overflow-y: auto;
            margin-bottom: 1rem;
        }

        .message {
            margin-bottom: 1rem;
            display: flex;
        }

        .message-bubble {
            max-width: 20rem;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
        }

        .message-system {
            justify-content: center;
        }

        .message-system .message-bubble {
            background-color: #f3f4f6;
            color: #4b5563;
            font-size: 0.875rem;
        }

        .message-user .message-bubble {
            background-color: #f97316;
            color: white;
            margin-left: auto;
        }

        .message-other .message-bubble {
            background-color: #e5e7eb;
            color: #111827;
        }

        .message-username {
            font-size: 0.75rem;
            opacity: 0.75;
            margin-bottom: 0.25rem;
        }

        .message-time {
            font-size: 0.75rem;
            opacity: 0.75;
            margin-top: 0.25rem;
        }

        .chat-input-container {
            background-color: white;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            padding: 1rem;
        }

        .chat-input-wrapper {
            display: flex;
            gap: 1rem;
        }

        .chat-input {
            flex: 1;
            padding: 0.5rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            outline: none;
        }

        .chat-input:focus {
            border-color: #f97316;
            box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.1);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            z-index: 50;
            display: none;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background-color: white;
            border-radius: 0.5rem;
            max-width: 32rem;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-large {
            max-width: 42rem;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-between;
            align-items: start;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #9ca3af;
            cursor: pointer;
            padding: 0;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.25rem;
        }

        .modal-close:hover {
            color: #4b5563;
            background-color: #f3f4f6;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1.5rem;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 1rem;
        }

        .modal-footer .btn {
            flex: 1;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: 0.5rem 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            outline: none;
        }

        .form-input:focus, .form-textarea:focus {
            border-color: #f97316;
            box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.1);
        }

        .form-textarea {
            resize: none;
            min-height: 100px;
        }

        .form-hint {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        .required {
            color: #ef4444;
        }

        /* Wallet Status */
        .wallet-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.25rem;
        }

        .status-dot {
            width: 0.5rem;
            height: 0.5rem;
            border-radius: 50%;
        }

        .status-dot.connected {
            background-color: #10b981;
        }

        .status-dot.disconnected {
            background-color: #ef4444;
        }

        .wallet-info {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .wallet-warning {
            font-size: 0.75rem;
            color: #f97316;
            margin-top: 0.25rem;
        }

        /* Supported Wallets */
        .supported-wallets {
            background-color: #f9fafb;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .supported-wallets-title {
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .wallets-grid {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .wallet-item {
            text-align: center;
        }

        .wallet-icon {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.75rem;
            margin-bottom: 0.25rem;
        }

        .wallet-icon.phantom {
            background-color: #a855f7;
        }

        .wallet-icon.solflare {
            background-color: #3b82f6;
        }

        .wallet-icon.backpack {
            background-color: #10b981;
        }

        .wallet-name {
            font-size: 0.75rem;
            color: #4b5563;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 3rem 0;
        }

        .loading-spinner {
            display: inline-block;
            width: 1.5rem;
            height: 1.5rem;
            border: 2px solid #f3f4f6;
            border-top-color: #f97316;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-right: 0.5rem;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem 0;
            color: #6b7280;
        }

        .empty-state-title {
            font-size: 1.125rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #4b5563;
        }

        /* Footer */
        footer {
            background-color: white;
            border-top: 1px solid #e5e7eb;
            margin-top: 4rem;
        }

        .footer-content {
            padding: 2rem 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .footer-links {
            display: flex;
            gap: 1.5rem;
        }

        .footer-links a {
            color: #6b7280;
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: #374151;
        }

        .footer-links .primary-link {
            color: #f97316;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .footer-links .primary-link:hover {
            color: #ea580c;
        }

        /* Utilities */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .logo-subtitle {
                display: none;
            }

            .btn span {
                display: none;
            }

            .btn {
                padding: 0.5rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .community-stats {
                flex-wrap: wrap;
                gap: 0.75rem;
            }

            .footer-content {
                text-align: center;
            }

            .footer-links {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <button class="logo-button" onclick="goHome()">
                        <div class="logo-icon">ðŸ¦´</div>
                        <div class="logo-text">Bonk</div>
                        <div class="logo-subtitle">Communities</div>
                    </button>
                    <div id="chatCommunityInfo" class="hidden" style="display: flex; align-items: center; gap: 0.5rem; margin-left: 1rem; padding-left: 1rem; border-left: 1px solid #e5e7eb;">
                        <span style="font-size: 1.5rem;">ðŸŽ¯</span>
                        <div>
                            <div id="chatCommunityName" style="font-weight: 600;"></div>
                            <div id="chatCommunitySymbol" style="font-size: 0.75rem; color: #6b7280;"></div>
                        </div>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <a href="https://x.com/BonkCommunities" target="_blank" rel="noopener noreferrer" class="btn btn-secondary" style="display: flex; align-items: center; gap: 0.5rem; text-decoration: none;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                        <span>X</span>
                    </a>
                    <button id="walletButton" class="btn btn-primary" onclick="handleWalletClick()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                            <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                            <path d="M18 12a2 2 0 0 0 0 4h4v-4h-4z"></path>
                        </svg>
                        <span>Connect Wallet</span>
                    </button>
                    <button class="btn btn-primary" onclick="showCreateModal()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        <span>Create Community</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container" style="padding: 2rem 1rem;">
        <!-- Home View -->
        <div id="homeView">
            <div class="hero">
                <h1>Token Communities</h1>
                <p>Join communities for tokens created on LetsBonk.fun. Connect with holders, share insights, and grow together.</p>
                
                <div class="search-container">
                    <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <input type="text" id="searchInput" class="search-input" placeholder="Search communities..." oninput="filterCommunities()">
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div id="totalCommunities" class="stat-value">0</div>
                        <div class="stat-label">Active Communities</div>
                    </div>
                    <div class="stat-card">
                        <div id="totalMembers" class="stat-value">0</div>
                        <div class="stat-label">Total Members</div>
                    </div>
                    <div class="stat-card">
                        <div id="totalPosts" class="stat-value">0</div>
                        <div class="stat-label">Total Posts</div>
                    </div>
                    <div class="stat-card">
                        <div id="totalOnline" class="stat-value">0</div>
                        <div class="stat-label">Online Now</div>
                    </div>
                </div>
            </div>

            <div id="loadingState" class="loading">
                <div class="loading-spinner"></div>
                <span>Loading communities...</span>
            </div>

            <div id="emptyState" class="empty-state hidden">
                <div class="empty-state-title">No communities yet</div>
                <p>Be the first to create a community for your LetsBonk.fun token!</p>
            </div>

            <div id="communitiesList" class="communities-list"></div>
        </div>

        <!-- Chat View -->
        <div id="chatView" class="hidden">
            <div class="chat-container">
                <div class="chat-header">
                    <div class="chat-header-content">
                        <div class="chat-header-info">
                            <div class="community-avatar">ðŸŽ¯</div>
                            <div>
                                <h2 id="chatHeaderName" style="font-size: 1.25rem; font-weight: 600;"></h2>
                                <p id="chatHeaderDescription" style="font-size: 0.875rem; color: #6b7280;"></p>
                            </div>
                        </div>
                        <div class="community-stats">
                            <div class="stat-item">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                    <circle cx="9" cy="7" r="4"></circle>
                                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                </svg>
                                <span id="chatMembersCount">0</span> members
                            </div>
                            <div class="stat-item">
                                <div class="online-dot"></div>
                                <span id="chatOnlineCount">0</span> online
                            </div>
                        </div>
                    </div>
                </div>

                <div id="chatMessages" class="chat-messages"></div>

                <div class="chat-input-container">
                    <div class="chat-input-wrapper">
                        <input 
                            type="text" 
                            id="messageInput" 
                            class="chat-input" 
                            placeholder="Type your message..." 
                            onkeypress="handleMessageKeyPress(event)"
                            disabled
                        >
                        <button 
                            id="sendButton" 
                            class="btn btn-primary" 
                            onclick="sendMessage()"
                            disabled
                        >
                            Send
                        </button>
                    </div>
                    <p id="chatWalletHint" class="form-hint" style="margin-top: 0.5rem;">Connect your wallet to send messages</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Wallet Prompt Modal -->
    <div id="walletPromptModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-body text-center">
                <div style="width: 4rem; height: 4rem; background-color: #fed7aa; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem;">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#f97316" stroke-width="2">
                        <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                        <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                        <path d="M18 12a2 2 0 0 0 0 4h4v-4h-4z"></path>
                    </svg>
                </div>
                
                <h2 class="modal-title" style="margin-bottom: 0.5rem;">Connect Wallet to Join</h2>
                
                <p style="color: #4b5563; margin-bottom: 0.5rem;">
                    You need to connect your Solana wallet to join <strong id="walletPromptCommunity"></strong> community.
                </p>
                
                <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 1.5rem;">
                    This ensures you're a verified member and can participate in discussions.
                </p>

                <div class="supported-wallets">
                    <div class="supported-wallets-title">Supported Wallets:</div>
                    <div class="wallets-grid">
                        <div class="wallet-item">
                            <div class="wallet-icon phantom">P</div>
                            <div class="wallet-name">Phantom</div>
                        </div>
                        <div class="wallet-item">
                            <div class="wallet-icon solflare">S</div>
                            <div class="wallet-name">Solflare</div>
                        </div>
                        <div class="wallet-item">
                            <div class="wallet-icon backpack">B</div>
                            <div class="wallet-name">Backpack</div>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 0.75rem;">
                    <button class="btn btn-secondary" style="flex: 1;" onclick="closeWalletPrompt()">Cancel</button>
                    <button id="connectWalletPromptBtn" class="btn btn-primary" style="flex: 1;" onclick="connectWalletAndJoin()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                            <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                            <path d="M18 12a2 2 0 0 0 0 4h4v-4h-4z"></path>
                        </svg>
                        <span>Connect Wallet</span>
                    </button>
                </div>

                <p id="noWalletWarning" class="wallet-warning hidden" style="margin-top: 0.75rem;">
                    No wallet detected. <a href="https://phantom.app/" target="_blank" rel="noopener noreferrer" style="color: #f97316; text-decoration: underline;">Install Phantom</a> to continue.
                </p>
            </div>
        </div>
    </div>

    <!-- Create Community Modal -->
    <div id="createModal" class="modal-overlay">
        <div class="modal modal-large">
            <div class="modal-header">
                <div>
                    <h2 class="modal-title">Create Community</h2>
                    <div class="wallet-status">
                        <div id="createModalStatusDot" class="status-dot disconnected"></div>
                        <span id="createModalWalletInfo" class="wallet-info">Wallet Not Connected</span>
                    </div>
                    <p id="createModalWalletWarning" class="wallet-warning hidden">
                        Install Phantom, Solflare, or Backpack wallet to create communities
                    </p>
                </div>
                <button class="modal-close" onclick="closeCreateModal()">Ã—</button>
            </div>

            <div class="modal-body">
                <form id="createCommunityForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Token Name <span class="required">*</span></label>
                            <input type="text" id="tokenName" class="form-input" placeholder="e.g., ChessBot" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Token Symbol <span class="required">*</span></label>
                            <input type="text" id="tokenSymbol" class="form-input" placeholder="e.g., ChessBot" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Token Address <span class="required">*</span></label>
                        <input type="text" id="tokenAddress" class="form-input" placeholder="Paste your LetsBonk.fun token address (CA:...bonkG)" required>
                        <p class="form-hint">Only tokens created on LetsBonk.fun are eligible</p>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Community Description</label>
                        <textarea id="description" class="form-textarea" placeholder="Describe your community and what token holders can expect..."></textarea>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Website (Optional)</label>
                            <input type="url" id="website" class="form-input" placeholder="https://...">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Twitter (Optional)</label>
                            <input type="text" id="twitter" class="form-input" placeholder="@username">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Telegram (Optional)</label>
                            <input type="text" id="telegram" class="form-input" placeholder="@channel">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Discord (Optional)</label>
                            <input type="text" id="discord" class="form-input" placeholder="Discord invite link">
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeCreateModal()">Cancel</button>
                <button id="createCommunityBtn" class="btn btn-primary" onclick="createCommunity()">Create Community</button>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div style="color: #6b7280;">Â© 2025 LetsBonk Communities. Built for the LetsBonk.fun ecosystem.</div>
                <div class="footer-links">
                    <a href="https://letsbonk.fun" target="_blank" rel="noopener noreferrer" class="primary-link">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                            <polyline points="15 3 21 3 21 9"></polyline>
                            <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                        LetsBonk.fun
                    </a>
                    <a href="#" style="color: #6b7280;">Discord</a>
                    <a href="#" style="color: #6b7280;">Telegram</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Global state
        let walletConnected = false;
        let walletAddress = '';
        let walletConnecting = false;
        let currentView = 'home';
        let selectedCommunity = null;
        let chatMessages = [];
        let communities = [];
        let allCommunities = [
            {
                id: 1,
                tokenName: 'ChessBot',
                tokenSymbol: 'ChessBot',
                tokenAddress: 'CA:FvxZ...bonkG',
                description: 'Official community for ChessBot token holders. Discuss strategies, share chess games, and connect with fellow players.',
                members: 12,
                posts: 3,
                online: 2,
                avatar: 'ðŸŽ¯',
                isVerified: true,
                createdHours: 2,
                lastActivity: '5m ago',
                tags: ['Gaming', 'Strategy', 'AI']
            },
            {
                id: 2,
                tokenName: 'Star Bonk',
                tokenSymbol: 'STAR',
                tokenAddress: 'CA:43xY...bonkG',
                description: 'Galactic community for STAR token. To the moon and beyond! Share memes, trading tips, and stellar content.',
                members: 8,
                posts: 1,
                online: 1,
                avatar: 'ðŸŽ¯',
                isVerified: true,
                createdHours: 6,
                lastActivity: '2m ago',
                tags: ['Space', 'Meme', 'Community']
            },
            {
                id: 3,
                tokenName: 'Donald Grump',
                tokenSymbol: 'Grump',
                tokenAddress: 'CA:G7AL...bonkG',
                description: 'The grumpiest community on Solana! Join fellow Grump holders for political memes and market discussions.',
                members: 15,
                posts: 7,
                online: 3,
                avatar: 'ðŸŽ¯',
                isVerified: false,
                createdHours: 4,
                lastActivity: '12m ago',
                tags: ['Political', 'Meme', 'Trending']
            },
            {
                id: 4,
                tokenName: 'Pepe Classic',
                tokenSymbol: 'PEPE',
                tokenAddress: 'CA:PE2E...bonkG',
                description: 'Classic Pepe community on Solana. Rare pepes, dank memes, and hodling strategies welcome here.',
                members: 23,
                posts: 4,
                online: 5,
                avatar: 'ðŸŽ¯',
                isVerified: true,
                createdHours: 12,
                lastActivity: '1m ago',
                tags: ['Pepe', 'Classic', 'Meme']
            }
        ];

        // Check wallet connection on load
        window.addEventListener('load', async () => {
            checkWalletConnection();
            loadCommunitiesGradually();
        });

        // Check if wallet is already connected
        async function checkWalletConnection() {
            if (typeof window !== 'undefined' && window.solana) {
                try {
                    const response = await window.solana.connect({ onlyIfTrusted: true });
                    if (response.publicKey) {
                        setWalletConnected(true, response.publicKey.toString());
                    }
                } catch (error) {
                    console.log('Wallet not auto-connected');
                }
            }
        }

        // Set wallet connected state
        function setWalletConnected(connected, address = '') {
            walletConnected = connected;
            walletAddress = address;
            updateWalletUI();
        }

        // Update wallet UI
        function updateWalletUI() {
            const walletButton = document.getElementById('walletButton');
            const createModalStatusDot = document.getElementById('createModalStatusDot');
            const createModalWalletInfo = document.getElementById('createModalWalletInfo');
            const createCommunityBtn = document.getElementById('createCommunityBtn');
            const messageInput = document.getElementById('messageInput');
            const sendButton = document.getElementById('sendButton');
            const chatWalletHint = document.getElementById('chatWalletHint');

            if (walletConnected) {
                walletButton.className = 'btn btn-wallet-connected';
                walletButton.innerHTML = `
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                        <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                        <path d="M18 12a2 2 0 0 0 0 4h4v-4h-4z"></path>
                    </svg>
                    <span>${walletAddress.slice(0, 4)}...${walletAddress.slice(-4)}</span>
                `;
                
                if (createModalStatusDot) {
                    createModalStatusDot.className = 'status-dot connected';
                    createModalWalletInfo.textContent = `Wallet Connected: ${walletAddress.slice(0, 8)}...`;
                    createCommunityBtn.disabled = false;
                    createCommunityBtn.textContent = 'Create Community';
                    createCommunityBtn.className = 'btn btn-primary';
                }

                if (messageInput) {
                    messageInput.disabled = false;
                    sendButton.disabled = false;
                    chatWalletHint.classList.add('hidden');
                }
            } else {
                walletButton.className = 'btn btn-primary';
                walletButton.innerHTML = `
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                        <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                        <path d="M18 12a2 2 0 0 0 0 4h4v-4h-4z"></path>
                    </svg>
                    <span>Connect Wallet</span>
                `;
                
                if (createModalStatusDot) {
                    createModalStatusDot.className = 'status-dot disconnected';
                    createModalWalletInfo.textContent = 'Wallet Not Connected';
                    createCommunityBtn.disabled = true;
                    createCommunityBtn.textContent = 'Connect Wallet First';
                    createCommunityBtn.className = 'btn btn-primary';
                    createCommunityBtn.style.opacity = '0.5';
                    createCommunityBtn.style.cursor = 'not-allowed';
                }

                if (messageInput) {
                    messageInput.disabled = true;
                    sendButton.disabled = true;
                    chatWalletHint.classList.remove('hidden');
                }
            }

            // Update no wallet warning
            const noWalletWarning = document.getElementById('noWalletWarning');
            const createModalWalletWarning = document.getElementById('createModalWalletWarning');
            
            if (!window.solana) {
                if (noWalletWarning) noWalletWarning.classList.remove('hidden');
                if (createModalWalletWarning) createModalWalletWarning.classList.remove('hidden');
            }
        }

        // Connect wallet
        async function connectWallet() {
            if (typeof window === 'undefined') {
                alert('Please use a browser that supports Solana wallets');
                return;
            }

            if (!window.solana) {
                alert('Please install a Solana wallet like Phantom, Solflare, or Backpack');
                window.open('https://phantom.app/', '_blank');
                return;
            }

            walletConnecting = true;
            updateConnectingUI();
            
            try {
                const response = await window.solana.connect();
                if (response.publicKey) {
                    setWalletConnected(true, response.publicKey.toString());
                    console.log('Connected to wallet:', response.publicKey.toString());
                }
            } catch (error) {
                console.error('Failed to connect wallet:', error);
                alert('Failed to connect wallet. Please try again.');
            } finally {
                walletConnecting = false;
                updateConnectingUI();
            }
        }

        // Disconnect wallet
        async function disconnectWallet() {
            if (window.solana) {
                try {
                    await window.solana.disconnect();
                    setWalletConnected(false);
                    console.log('Wallet disconnected');
                } catch (error) {
                    console.error('Failed to disconnect wallet:', error);
                }
            }
        }

        // Update UI during connection
        function updateConnectingUI() {
            const walletButton = document.getElementById('walletButton');
            const connectWalletPromptBtn = document.getElementById('connectWalletPromptBtn');

            if (walletConnecting) {
                walletButton.disabled = true;
                walletButton.innerHTML = `
                    <div class="loading-spinner" style="width: 16px; height: 16px;"></div>
                    <span>Connecting...</span>
                `;
                
                if (connectWalletPromptBtn) {
                    connectWalletPromptBtn.disabled = true;
                    connectWalletPromptBtn.innerHTML = `
                        <div class="loading-spinner" style="width: 16px; height: 16px;"></div>
                        <span>Connecting...</span>
                    `;
                }
            } else {
                walletButton.disabled = false;
                if (connectWalletPromptBtn) {
                    connectWalletPromptBtn.disabled = false;
                    connectWalletPromptBtn.innerHTML = `
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                            <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                            <path d="M18 12a2 2 0 0 0 0 4h4v-4h-4z"></path>
                        </svg>
                        <span>Connect Wallet</span>
                    `;
                }
                updateWalletUI();
            }
        }

        // Handle wallet button click
        function handleWalletClick() {
            if (walletConnected) {
                disconnectWallet();
            } else {
                connectWallet();
            }
        }

        // Load communities gradually
        function loadCommunitiesGradually() {
            const loadingState = document.getElementById('loadingState');
            const emptyState = document.getElementById('emptyState');
            
            // Show loading state
            loadingState.classList.remove('hidden');
            emptyState.classList.add('hidden');

            // Simulate loading delay
            setTimeout(() => {
                // Add communities one by one
                allCommunities.forEach((community, index) => {
                    const delay = index === 0 ? 2000 : 2000 + (index * 3000);
                    setTimeout(() => {
                        communities.push(community);
                        renderCommunities();
                        updateStats();
                    }, delay);
                });

                // Hide loading state after all communities are loaded
                setTimeout(() => {
                    loadingState.classList.add('hidden');
                    if (communities.length === 0) {
                        emptyState.classList.remove('hidden');
                    }
                }, 2000 + (allCommunities.length * 3000) + 500);
            }, 1000);
        }

        // Render communities
        function renderCommunities() {
            const communitiesList = document.getElementById('communitiesList');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            const filteredCommunities = communities.filter(community =>
                community.tokenName.toLowerCase().includes(searchTerm) ||
                community.tokenSymbol.toLowerCase().includes(searchTerm) ||
                community.tags.some(tag => tag.toLowerCase().includes(searchTerm))
            );

            communitiesList.innerHTML = filteredCommunities.map((community, index) => `
                <div class="community-card animate" style="animation-delay: ${index * 0.2}s;">
                    <div class="community-header">
                        <div class="community-info">
                            <div class="community-avatar">${community.avatar}</div>
                            <div class="community-details">
                                <div class="community-name">
                                    ${community.tokenName}
                                    ${community.isVerified ? '<svg class="verified-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>' : ''}
                                    <span style="font-size: 0.875rem; color: #6b7280; font-weight: normal;">(${community.tokenSymbol})</span>
                                </div>
                                <div class="community-address">${community.tokenAddress}</div>
                                <div class="community-description">${community.description}</div>
                                <div class="community-tags">
                                    ${community.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                                </div>
                                <div class="community-stats">
                                    <div class="stat-item">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                            <circle cx="9" cy="7" r="4"></circle>
                                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                        </svg>
                                        <span>${community.members.toLocaleString()} members</span>
                                    </div>
                                    <div class="stat-item">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                                        </svg>
                                        <span>${community.posts} posts</span>
                                    </div>
                                    <div class="stat-item">
                                        <div class="online-dot"></div>
                                        <span>${community.online} online</span>
                                    </div>
                                    <div class="stat-item">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <polyline points="12 6 12 12 16 14"></polyline>
                                        </svg>
                                        <span>Last activity ${community.lastActivity}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="joinCommunity(${community.id})">Join</button>
                    </div>
                </div>
            `).join('');
        }

        // Update stats
        function updateStats() {
            document.getElementById('totalCommunities').textContent = communities.length;
            document.getElementById('totalMembers').textContent = communities.reduce((sum, c) => sum + c.members, 0).toLocaleString();
            document.getElementById('totalPosts').textContent = communities.reduce((sum, c) => sum + c.posts, 0);
            document.getElementById('totalOnline').textContent = communities.reduce((sum, c) => sum + c.online, 0);
        }

        // Filter communities
        function filterCommunities() {
            renderCommunities();
        }

        // Join community
        function joinCommunity(communityId) {
            const community = communities.find(c => c.id === communityId);
            if (!community) return;

            selectedCommunity = community;

            if (!walletConnected) {
                showWalletPrompt();
                return;
            }

            enterChatRoom();
        }

        // Show wallet prompt
        function showWalletPrompt() {
            const modal = document.getElementById('walletPromptModal');
            const communityName = document.getElementById('walletPromptCommunity');
            communityName.textContent = selectedCommunity.tokenName;
            modal.classList.add('show');
        }

        // Close wallet prompt
        function closeWalletPrompt() {
            const modal = document.getElementById('walletPromptModal');
            modal.classList.remove('show');
            selectedCommunity = null;
        }

        // Connect wallet and join
        async function connectWalletAndJoin() {
            await connectWallet();
            if (walletConnected && selectedCommunity) {
                closeWalletPrompt();
                enterChatRoom();
            }
        }

        // Enter chat room
        function enterChatRoom() {
            // Initialize chat messages
            chatMessages = [
                {
                    id: 1,
                    user: 'System',
                    message: `Welcome to ${selectedCommunity.tokenName} community!`,
                    timestamp: new Date().toLocaleTimeString(),
                    isSystem: true
                },
                {
                    id: 2,
                    user: 'TokenBot',
                    message: `Current token: ${selectedCommunity.tokenSymbol} | Address: ${selectedCommunity.tokenAddress}`,
                    timestamp: new Date().toLocaleTimeString(),
                    isSystem: true
                }
            ];

            // Update UI
            currentView = 'chat';
            showChatView();
            renderChatMessages();
        }

        // Show chat view
        function showChatView() {
            document.getElementById('homeView').classList.add('hidden');
            document.getElementById('chatView').classList.remove('hidden');
            
            // Update header
            document.getElementById('chatCommunityInfo').classList.remove('hidden');
            document.getElementById('chatCommunityName').textContent = selectedCommunity.tokenName;
            document.getElementById('chatCommunitySymbol').textContent = selectedCommunity.tokenSymbol;
            
            // Update chat header
            document.getElementById('chatHeaderName').textContent = selectedCommunity.tokenName;
            document.getElementById('chatHeaderDescription').textContent = selectedCommunity.description;
            document.getElementById('chatMembersCount').textContent = selectedCommunity.members;
            document.getElementById('chatOnlineCount').textContent = selectedCommunity.online;
            
            updateWalletUI();
        }

        // Render chat messages
        function renderChatMessages() {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = chatMessages.map(message => {
                if (message.isSystem) {
                    return `
                        <div class="message message-system">
                            <div class="message-bubble">
                                <div>${message.message}</div>
                                <div class="message-time">${message.timestamp}</div>
                            </div>
                        </div>
                    `;
                } else {
                    const isOwnMessage = message.user === `${walletAddress.slice(0, 4)}...${walletAddress.slice(-4)}`;
                    return `
                        <div class="message ${isOwnMessage ? 'message-user' : 'message-other'}">
                            <div class="message-bubble">
                                ${!isOwnMessage ? `<div class="message-username">${message.user}</div>` : ''}
                                <div>${message.message}</div>
                                <div class="message-time">${message.timestamp}</div>
                            </div>
                        </div>
                    `;
                }
            }).join('');
            
            // Scroll to bottom
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Send message
        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message || !walletConnected) return;
            
            chatMessages.push({
                id: chatMessages.length + 1,
                user: `${walletAddress.slice(0, 4)}...${walletAddress.slice(-4)}`,
                message: message,
                timestamp: new Date().toLocaleTimeString(),
                isSystem: false
            });
            
            messageInput.value = '';
            renderChatMessages();
        }

        // Handle message key press
        function handleMessageKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Go home
        function goHome() {
            currentView = 'home';
            selectedCommunity = null;
            chatMessages = [];
            
            document.getElementById('homeView').classList.remove('hidden');
            document.getElementById('chatView').classList.add('hidden');
            document.getElementById('chatCommunityInfo').classList.add('hidden');
        }

        // Show create modal
        function showCreateModal() {
            const modal = document.getElementById('createModal');
            modal.classList.add('show');
            updateWalletUI();
        }

        // Close create modal
        function closeCreateModal() {
            const modal = document.getElementById('createModal');
            modal.classList.remove('show');
            
            // Reset form
            document.getElementById('createCommunityForm').reset();
        }

        // Create community
        function createCommunity() {
            if (!walletConnected) {
                alert('Please connect your Solana wallet first to create a community!');
                return;
            }
            
            const tokenName = document.getElementById('tokenName').value.trim();
            const tokenSymbol = document.getElementById('tokenSymbol').value.trim();
            const tokenAddress = document.getElementById('tokenAddress').value.trim();
            const description = document.getElementById('description').value.trim();
            
            if (!tokenName || !tokenSymbol || !tokenAddress) {
                alert('Please fill in all required fields (Token Name, Symbol, and Address)');
                return;
            }
            
            const newCommunity = {
                id: allCommunities.length + communities.length + 1,
                tokenName: tokenName,
                tokenSymbol: tokenSymbol,
                tokenAddress: tokenAddress,
                description: description || 'A new community for token holders.',
                members: 1,
                posts: 0,
                online: 1,
                avatar: 'ðŸŽ¯',
                isVerified: false,
                createdHours: 0,
                lastActivity: 'Just now',
                tags: ['New', 'Community']
            };
            
            communities.unshift(newCommunity);
            renderCommunities();
            updateStats();
            closeCreateModal();
            
            // Navigate to chat room for the new community
            selectedCommunity = newCommunity;
            enterChatRoom();
        }

        // Close modal on overlay click
        document.getElementById('walletPromptModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeWalletPrompt();
            }
        });

        document.getElementById('createModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCreateModal();
            }
        });
    </script>
</body>
</html>